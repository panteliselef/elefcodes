import{e as p,a as z}from"./index.3whys8t3.js";var A=(e,n,r)=>!e&&r?N(r):R(n),N=e=>{const n=e.userId,r=e.user,o=e.sessionId,s=e.session,i=e.organization,t=e.orgId,u=e.orgRole,v=e.orgPermissions,g=e.orgSlug,l=e.actor;return{userId:n,user:r,sessionId:o,session:s,organization:i,orgId:t,orgRole:u,orgPermissions:v,orgSlug:g,actor:l}},R=e=>{var n;const r=e.user?e.user.id:e.user,o=e.user,s=e.session?e.session.id:e.session,i=e.session,t=i?.actor,u=e.organization,v=e.organization?e.organization.id:e.organization,g=u?.slug,l=u&&((n=o?.organizationMemberships)==null?void 0:n.find(U=>U.organization.id===v)),a=l&&l.permissions,c=l&&l.role;return{userId:r,user:o,sessionId:s,session:i,organization:u,orgId:v,orgRole:c,orgSlug:g,orgPermissions:a,actor:t}},_="METHOD_CALLED";function D(e,n){return{event:_,payload:{method:e,...n}}}const C=5,f=6,m=10;let x=(e,n,r,o)=>(e.events=e.events||{},e.events[r+m]||(e.events[r+m]=o(s=>{e.events[r].reduceRight((i,t)=>(t(i),i),{shared:{},...s})})),e.events[r]=e.events[r]||[],e.events[r].push(n),()=>{let s=e.events[r],i=s.indexOf(n);s.splice(i,1),s.length||(delete e.events[r],e.events[r+m](),delete e.events[r+m])}),P=1e3,E=(e,n)=>x(e,o=>{let s=n(o);s&&e.events[f].push(s)},C,o=>{let s=e.listen;e.listen=(...t)=>(!e.lc&&!e.active&&(e.active=!0,o()),s(...t));let i=e.off;return e.events[f]=[],e.off=()=>{i(),setTimeout(()=>{if(e.active&&!e.lc){e.active=!1;for(let t of e.events[f])t();e.events[f]=[]}},P)},()=>{e.listen=s,e.off=i}}),L=(e,n,r)=>{Array.isArray(e)||(e=[e]);let o,s,i=()=>{if(s===p)return;s=p;let l=e.map(a=>a.get());if(!o||l.some((a,c)=>a!==o[c])){o=l;let a=n(...l);a&&a.then&&a.t?a.then(c=>{o===l&&t.set(c)}):(t.set(a),s=p)}},t=z(void 0),u=t.get;t.get=()=>(i(),u());let v,g=r?()=>{clearTimeout(v),v=setTimeout(i)}:i;return E(t,()=>{let l=e.map(a=>a.listen(g));return i(),()=>{for(let a of l)a()}}),t},d=(e,n)=>L(e,n),F=(e,n)=>L(e,n,!0),M=(e={})=>{let n=z(e);return n.setKey=function(r,o){let s=n.value;typeof o>"u"&&r in n.value?(n.value={...n.value},delete n.value[r],n.notify(s,r)):n.value[r]!==o&&(n.value={...n.value,[r]:o},n.notify(s,r))},n};var h=M({isLoaded:!1,client:void 0,user:void 0,session:void 0,organization:void 0}),H=M(),O=z(null),w=d([h],e=>e.isLoaded),I=F([h,H],(e,n)=>A(e.isLoaded,{session:e.session,user:e.user,organization:e.organization,client:e.client},n));d([I],e=>e.user);var B=d([I],e=>e.session),V=d([I],e=>e.organization),T=d([h],e=>e.client),G=d([O],e=>e);d([T],e=>e?.sessions);var Y=d([T],e=>e?.signIn),$=d([T],e=>e?.signUp),S=(e,n)=>{E(e,()=>{O.get()?.telemetry?.record(D(n))})};S(Y,"$signInStore");S($,"$signUpStore");S(V,"$organizationStore");export{O as $,h as a,G as b,H as c,w as d,I as e,B as f};
